
<template id="xcircle-el">
  <style>.circle-el__title { color: orange; }</style><span class="circle-el__title">My Circle Title</span>
  <p></p>
  <div>
    <div id="c1"></div>
  </div>
</template>
<!--http://github.com/lugolabs/circles-->
<script>
  var CircleEl = Object.create(HTMLElement.prototype) //prototype
  var circleEl = null //instance, to keep state
  
  CircleEl.loadedLib = function() {
  
  	if (circleEl._loaded) return
  	circleEl._loaded = true
  	console.log('loaded')
  	
  	var c = circleEl._shadow.getElementById('c1')
  	circleEl.circle = Circles.create({
  		el:                  c,
  		radius:              60,
  		value:               42,
  		maxValue:            100,
  		width:               10,
  		text:                function(value){return value + '%';},
  		colors:              ['#D3B6C6', '#4B253A'],
  		duration:            400,
  		wrpClass:            'circles-wrp',
  		textClass:           'circles-text',
  		valueStrokeClass:    'circles-valueStroke',
  		maxValueStrokeClass: 'circles-maxValueStroke',
  		styleWrapper:        true,
  		styleText:           true
  		})
  }//loaded
  
  CircleEl.createdCallback = function() {
  	circleEl = this
  	circleEl._shadow = TW.attachShadow(circleEl, '#xcircle-el')
  	circleEl._loaded = false //trap
  
  	TS.load('https://cdn.rawgit.com/topseed/topseed-webcomps/master/_sharedComps/vendor/circlesMOD.js')
  	.then(circleEl.loadedLib)
  	
  }//created
  
  //var blx = null //message bus to broadcast to
  
  CircleEl.init = function(_blx) {
  	//blx = _blx //required for outgoing/broadcast only
  	//listen 
  	_blx.on('mySelection', function(data) { //incoming
  		circleEl.circle.update(data.circleVal)
  	})
  	//same as:
  	/*flyd.on(function(data) { 
  			circleEl.circle.update(data.circleVal)
  	}, _blx.observer('mySelection'))*/
  
  }
</script>
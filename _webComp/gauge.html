
<template id="xgauge-el">
  <style>.bgauge-el span { color: orange; }</style>
  <div class="bgauge-el"><span>My Gauge Title (Shadow DOM)</span>
    <p></p>
    <div>
      <div id="gauge1"></div>
    </div>
  </div>
</template>
<!--http://justgage.com/ -->
<script>
  var GaugeEl = Object.create(HTMLElement.prototype)
  GaugeEl.createdCallback = function() {
  	GaugeEl._shadow = TW.attachShadow(this, '#xgauge-el')
  	TW.registerCustomElement('gauge-el', GaugeEl) //could be in the page compInit callback
  
  	console.log('created')
  	
  	GaugeEl._loaded = false//trap
  
  	TS.load('https://cdn.rawgit.com/topseed/topseed-turbo/master/vendor/raphael.min.js', function(){
  	TS.load('https://cdn.rawgit.com/topseed/topseed-webcomps/master/_webComp/vendor/justgage.js', GaugeEl.loadedLib )
  	})
  
  }//created
  
  GaugeEl.g //gauge implementation instance
  
  GaugeEl.loadedLib = function(gaugeVal) {
  	if(!gaugeVal && GaugeEl._loaded) return
  	GaugeEl._loaded = true
  	console.log('loaded')
  
  	var c = $('#gauge1', GaugeEl._shadow)[0]
  	GaugeEl.g = new JustGage({
  		parentNode : c,
  		value: gaugeVal||67, 
  		min: 0,
  		max: 100,
  		title: 'Visitors'
  	})
  }//loaded
  
  GaugeEl.init = function(_blx) {
  	//blx = _blx //for outgoing only
  	//listen 
  	_blx.on('mySelection', function(data) { 
  		GaugeEl.g.refresh(data.gaugeVal)
  	})
  	//same as:
  	/*flyd.on(function(data) { 
  			GaugeEl.g.refresh(data.gaugeVal)
  	}, _blx.observer('mySelection'))*/
  
  }
</script>